<!DOCTYPE HTML>

<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

    <title>DMAssassins</title>
    <link href="/bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="/bower_components/fontawesome/css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="/bower_components/bootstrap-social-buttons/social-buttons.css" rel="stylesheet" type="text/css">
    <link href="/bower_components/datatables/media/css/jquery.dataTables.css" rel="stylesheet" type="text/css">
    <link href="/bower_components/datatables-bootstrap3/BS3/assets/css/datatables.css" rel="stylesheet" type="text/css">
    <link href="assets/styles/site.css" rel="stylesheet" type="text/css">
    <link href="assets/styles/sidebar.css" rel="stylesheet" type="text/css">

    <script id="nav-template" type="text/template">
        <nav role="navigation" class="navbar navbar-default navbar-fixed-top">
          <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button data-target="#main_nav" data-toggle="collapse" class="navbar-toggle" type="button">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="#" class="navbar-brand">DMAssassins</a>
            </div>
        
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="main_nav">
                <ul class="nav navbar-nav">
                    <li class="nav_item" id="nav_target"><a href="#target">Target</a></li>
                    <li class="nav_item" id="nav_my_profile"><a href="#my_profile">My Profile</a></li>
                    <li class="nav_item" id="nav_leaderboard"><a href="#leaderboard">Leaderboard</a></li>
                    <li class="nav_item" id="nav_rules"><a href="#rules">Rules</a></li>
                </ul>
                            
                <ul class="nav navbar-nav navbar-right">
                    <li class="nav_item dropdown_parent" id="games_parent">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <div class="hidden-sm">
                                <span id="games_header">
                                    Loading..
                                </span>
                                <span class="caret"></span>
                            </div>
                            <div class="visible-sm">
                                <span id="games_header_short">
                                    Loading..
                                </span>
                                <span class="caret"></span>
                            </div>
                        </a> 
                        <ul class="dropdown-menu" role="menu" id="games_dropdown">
                        </ul>
                    </li>
                    <li id="admin_parent" class="nav_item dropdown_parent hide">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <div class="hidden-sm">
                                <span id="admin_header">
                                    Admin
                                </span>
                                <span class="caret"></span>                                     
                            </div>
                            <div class="visible-sm">
                                <span id="admin_header_short">
                                    Admin
                                </span>
                                <span class="caret"></span>
                            </div>
                        </a>
                        <ul id="admin_dropdown" role="menu" class="dropdown-menu">
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_users"><a href="#users">Users</a></li>  
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_edit_rules"><a href="#users">Edit Rules</a></li> 
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_teams"><a href="#teams">Teams</a></li>  
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_plot_twists"><a href="#plot_twists">Plot Twists</a></li>    
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_twitter"><a href="#twitter">Twitter</a></li>    
                            <li class="nav_item dropdown_item" dropdown="admin" id="nav_game_settings"><a href="#game_settings">Game Settings</a></li>      
                        </ul>
                    </li>   
                    <li class="nav_item" id="nav_logout">
                        <a href="#logout">
                            Logout
                        </a>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->            
      </div><!-- /.container-fluid -->
    </nav>
                        
    </script>
    <script id="nav-game-template" type="text/template">
    <%
        _.each(games, function(game) {
        %>
            <li id="nav_<%=game.game_id %>" class="nav_item dropdown_item game_name" dropdown="games"><a game_id="<%=game.game_id %>" class="switch_game" href="#switch_game"><%=game.game_name%></a></li>
        <%
        })
        %>
        <li id="nav_create_game" class="nav_item dropdown_item" dropdown="games"><a href="#create_game">Create New Game</a></li>
        <li id="nav_join_game" class="nav_item dropdown_item" dropdown="games"><a href="#join_game">Join New Game</a></li>
    </script>
    <script id="target-template" type="text/template">
    <div class="user_view">
             <div class="view text-center">
                <div id="target_data">
                    <div class="row">
                        <label>Name:</label> <%= properties.name %>
                    </div>
                    <div class="row">
                        <label>Email:</label> <a href="mailto:"<%= email %>"><%= email %></a>
                    </div>
                    <div class="row">
                        <label>Facebook:</label> <a href="<%= properties.facebook %>"><%= properties.facebook.replace('https://facebook','fb') %></a>
                    </div>
                </div>
                <% if (properties.team) { %>                
                        <div class="row">
                            <label>Team:</label> <%= properties.team %>
                        </div>
                    <% } %>
                <div class="row">
                    <a class="thumbnail">
                       <img src=<%= properties.photo_thumb %>>
                    </a>
                </div>
                <div class="row user-column">
                    <form class="form-inline kill-form" id="kill_form">
                        <input class="form-control" placeholder="Enter Secret" id="secret"/>
                        <button type="button" id="kill" class="btn btn-danger">Kill Target</button>
                    </form>
                    
                </div>
             </div>
        </div>
        <div class="modal fade" id="photoModal" tabindex="-1" role="dialog" aria-labelledby="photoModal" aria-hidden="true">
          <div class="modal-dialog">
            <img class="img-responsive center-block" src=<%= properties.photo %> />   
          </div>
        </div>
        
    </script>
    <script id="profile-template" type="text/template">
    <div class="user_view">
             <div class="view text-center">
                <div id="target_data">
                    <div class="row">
                        <label>Name:</label> <%= properties.name %>
                    </div>
                    <div class="row">
                        <label>Email:</label> <a href="mailto:"<%= email %>"><%= email %></a>
                    </div>
                    <div class="row">
                        <label>Facebook:</label> <a href="<%= properties.facebook %>"><%= properties.facebook.replace('https://facebook','fb') %></a>
                    </div>
                    <% if (properties.team) { %>                
                        <div class="row">
                            <label>Team:</label> <%= properties.team %>
                        </div>
                    <% } %>
                    <div class="row">                       
                        <div class="text-danger"><label>Secret:</label> <%= properties.secret %></div>
                        <p class="text-danger">
                            Give this to your assassin if they kill you.
                        </p>
                    </div>
                </div>
                <div class="row">
                    <a class="thumbnail">
                       <img src=<%= properties.photo_thumb %>>
                    </a>
                </div>
                <div class="row user-column">
                    <button class="btn btn-block btn-danger" id="quit">Quit Game</button>
                </div>
             </div>
        </div>
        <div class="modal fade" id="photoModal" tabindex="-1" role="dialog" aria-labelledby="photoModal" aria-hidden="true">
          <div class="modal-dialog">
            <img class="img-responsive center-block" src=<%= properties.photo %> />   
          </div>
        </div>
        
        <div id="quit_modal_wrapper">
        
        </div>
    </script>
    <script id="quit-modal-template" type="text/template">

        <div class="modal fade" id="quit_modal" role="dialog">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Quit Game</h4>
              </div>
              <form class="form-inline" role="form">
                  <div class="modal-body">
                    <p>We're sad to see you go. If you really want to quit <strong><%=quit_game_name%></strong> please confirm by entering your secret:</p>
                     <div class="form-group">
                         <label for="quit_secret" class="sr-only">Secret:</label><input class="form-control" id="quit_secret" type="text" placeholder ="Enter Secret"/>
                     </div>
                  </div>
                  <div class="modal-footer">
                    <button class="btn btn-default btn-medium" data-dismiss="modal">Nevermind</button>
                    <button class="btn btn-danger btn-medium" id="quit_game_confirm">Quit</button>
                  </div>
              </form>  
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        

    </script>
    <script id="select-game-template" type="text/template">
    <div class="container-fluid">
            <img src="/assets/img/logo.png" class="center-block img-responsive logo" /> 
            <div id="create-or-join" class="">
                <div class="container col-md-offset-2 col-md-8 text-center">
                    <div class="hidden-xs">
                        <button class="btn btn-facebook btn-lg show-create-game">Create A Game</button>
                        <button class="btn btn-facebook btn-lg show-join-game">Join A Game</button>             
                    </div>
                    <div class="visible-xs-block">
                        <button class="btn btn-facebook btn-block show-create-game">Create A Game</button>
                        <button class="btn btn-facebook btn-block show-join-game">Join A Game</button>              
                    </div>

                </div>              
            </div>
            <div id="create-game" class="container hide">
                <form class="form-horizontal text-left" role="form">            
                    <div class="form-group">
                        <h1 class="text-center col-sm-12 col-xs-12">Create a Game</h1>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-5 col-xs-5 control-label" for="create_game_name">Game Name:</label>
                        <div class="col-sm-3 col-xs-7">
                            <input id="create_game_name" class="form-control"></input>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-5 col-xs-5 control-label" for="create_game_need_password">Password protect?:</label>
                        <div class="col-sm-3 col-xs-7">
                            <input id="create_game_need_password" type="checkbox"</input>
                        </div>
                    </div>
                    <div id="create_password_block" class="form-group">
                        <label class="col-sm-5 col-xs-5 control-label" for="create_game_password">Password:</label>
                        <div class="col-sm-3 col-xs-7">
                            <input id="create_game_password" class="form-control" disabled></input>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="hidden-xs">
                            <div class="col-sm-offset-5 col-sm-2">
                                <button class="btn btn-default btn-block create-game-submit">Create</button>                            
                            </div>
                            <div class="col-sm-1">
                                <button class="btn btn-danger btn-block create-or-join-back">Back</button>
                            </div>
                        </div>
                        <div class="visible-xs-block">
                            <button class="btn btn-default btn-block create-game-submit">Create</button>
                            <button class="btn btn-danger btn-block create-or-join-back">Back</button>                          
                        </div>
                    </div>
                        
                </form>
            </div>
            <div id="join-game" class="container hide">
                <form class="form-horizontal text-left" role="form">
                    <div class="form-group">
                        <h1 class="text-center col-sm-12 col-xs-12">Select a Game</h1>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-5 col-xs-5 control-label" for="games">Game:</label>
                        <div class="col-sm-3 col-xs-7">
                            <select id="games" class="form-control">
                                <% _.each(games, function(game){ %>     
                                    <option value=<%= game.game_id %> game_has_password=<%= game.game_has_password %>><%= game.game_name %> </option>               
                                <% }) %>
                            </select>
                        </div>
                    </div>
                    <div id="join_password_block" class="form-group">
                        <label class="col-sm-5 col-xs-5 control-label" for="join_game_password">Password:</label>
                        <div class="col-sm-3 col-xs-7">
                            <input id="join_game_password" class="form-control" disabled></input>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="hidden-xs">
                            <div class="col-sm-offset-5 col-sm-2">
                                <button class="btn btn-default btn-block join-game-submit">Join</button>                            
                            </div>
                            <div class="col-sm-1">
                                <button class="btn btn-danger btn-block create-or-join-back">Back</button>
                            </div>
                        </div>
                        <div class="visible-xs-block">
                            <button class="btn btn-default btn-block join-game-submit">Join</button>
                            <button class="btn btn-danger btn-block create-or-join-back">Back</button>                          
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </script>
    <script id="login-template" type="text/template">
    <div class="col-md-2"></div>
        <div class="container col-md-8">
            <img src="/assets/img/logo.png" class="center-block img-responsive logo" />
            <button class="btn btn-facebook btn-lg center-block hidden-xs"><i class="fa fa-facebook"></i> | Connect with Facebook</button>          
        </div>
        <div class="col-md-2"></div>
        <button class="btn btn-facebook btn-block center-block visible-xs-block"><i class="fa fa-facebook"></i> | Connect with Facebook</button>
    </script>
    <script id="leaderboard-template" type="text/template">
    <h3>Player Rankings</h3>
        <table class="stripe compact" id="user_leaderboard_table">
            <thead>
                <th style="width:<%=user_col_width%>%">Name</th>
                <% if (teams_enabled) { %>
                    <th style="width:<%=user_col_width%>%">Team</th>
                <% } %>
                <th style="width:<%=user_col_width%>%">Alive</th>
                <th style="width:<%=user_col_width%>%">Kills</th>
            </thead>
            <tbody>
                    <%
                    _.each(users, function(user) {          
                    %>
                    <tr>
                        <td><%=user.name%></td>
                        <% if (teams_enabled) { %>
                            <td><%= user.team_name %></td>
                        <% } %>
                        <td><%=user.alive ? 'Yes' : 'No'%></td>
                        <td><%=user.kills%></td>                        
                    </tr>                   
                    <%
                    })
                    %>
            </tbody>
        </table>
        <% if (teams_enabled) { %>
            <h3>Team Rankings</h3>
            <table class="stripe compact" id="team_leaderboard_table">
                <thead>
                    <th>Team Name</th>
                    <th>Total Players</th>
                    <th>Players Left</th>                   
                    <th>Kills</th>
                    <th>Avg Kills</th>
                </thead>
                <tbody>
                        <%
                        _.each(teams, function(team, name) {                        
                        %>
                        <tr>
                            <td style="width:<%=team_col_width%>%"><%=name%></td>
                            <td style="width:<%=team_col_width%>%"><%=team.players%></td>
                            <td style="width:<%=team_col_width%>%"><%=team.alive%></td>
                            <td style="width:<%=team_col_width%>%"><%=team.kills%></td>
                            <td style="width:<%=team_col_width%>%"><%=parseFloat(team.kills/team.players).toFixed(2)%></td>                         
                        </tr>                   
                        <%
                        })
                        %>
                </tbody>
            </table>
        <% } %>
    </script>
    <script id="rules-template" type="text/template">
    <%= rules %>
    </script>
    
    <script id="admin-users-teams-template" type="text/template">
        <li>
            Show All
        </li>
        <li>
            No Team
        </li>
        <li>
            New Team
        </li>         
        <%
        _.each(teams, function(team){
        %>
            <li data-team-id=<%= team.team_id %> data-team-name=<%= team.team_name %>> <%= team.team_name %> </li>
        <%
        })
        %>
    </script>
    
    <script id="admin-users-template" type="text/template">
        <div class="teams hidden-xs">
            <div class="sidebar-wrapper">
                <ul id="team_list" class="sidebar-nav">

                </ul>
            </div>  
        </div>
        <div class="admin-users-body">
            <%
            _.each(users, function(user) {
            %>
                <div class="user-grid col-xs-12 col-sm-6 col-md-4 col-lg-3" data-user-id=<%= user.user_id %>>
                     <img class="drag-img hide" src=<%= user.properties.photo_thumb %>>
                     <div class="user">
                         <div class="user-column text-center">
                            <div class="row">
                                <h3><%= user.properties.first_name + ' ' + user.properties.last_name %></h3>
                                <a href="mailto:<%= user.email %>" class="subtext"><%= user.email %></a><br />
                                <a href="<%= user.properties.facebook %>" class="subtext">View Facebook</a>
                            </div>
    
                            <div class="row">
                                <a class="thumbnail">
                                   <img src=<%= user.properties.photo_thumb %>>
                                </a>
                            </div>
                            <div class="user-data-text">
                                <div class="row">
                                    <label>Team:</label> <select><option> <%= user.properties.team %> </option></select>
                                </div>
                                <div class="row">
                                    <label>Role:</label> <select><option><%= AuthUtils.getRolePrettyName(user.properties.user_role) %></option></select>
                                </div>
                            </div>
                            <div class ="user-buttons btn-group btn-group-justified kill-user-wrapper">
                                <div class="btn-group">
                                    <button type="button" data-user-id ="<%=user.user_id %>" data-user-name ="<%=user.properties.first_name + ' ' + user.properties.last_name %>" class="btn btn-danger ban-user">Ban</button>
                                </div>
                                <div class="btn-group">                            
                                    <button type="button" data-user-id ="<%=user.user_id %>" data-user-name ="<%=user.properties.first_name + ' ' + user.properties.last_name %>" class="btn btn-danger kill-user">Kill</button>
                                </div>
                            </div>
                            <div class ="user-buttons btn-group btn-group-justified revive-user-wrapper hide">
                                <div class="btn-group">
                                    <button type="button" data-user-id ="<%=user.user_id %>" data-user-name ="<%=user.properties.first_name + ' ' + user.properties.last_name %>" class="btn btn-danger ban-user">Ban</button>
                                </div>
                                <div class="btn-group">                            
                                    <button type="button" data-user-id ="<%=user.user_id %>" data-user-name ="<%=user.properties.first_name + ' ' + user.properties.last_name %>" class="btn btn-primary revive-user">Revive</button>
                                </div>
                            </div>
                         </div>
                    </div>
                </div>
            <%
            })
            %>
        </div>
        
        
        <div id="ban_user_modal" class="modal fade">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Ban User</h4>
              </div>
              <div class="modal-body">
                <p>Are you sure you want to ban <strong><span class="user-name"></span></strong>? They will be permanently removed from the game and leaderboard. <br />
                    <strong>This action cannot be undone.</strong><br />
                    If you just want to kill them close this window and click "Kill User."
                </p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-danger" id="ban_user_submit">Ban User</button>
              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
        
    </script>
    
    
    <script src="js/config.js" type="text/javascript"></script>
    <script src="/bower_components/jquery/dist/jquery.js" type="text/javascript"></script>
    <script src="/bower_components/jquery-ui/jquery-ui.js" type="text/javascript"></script>
    <script src="/bower_components/underscore/underscore.js" type="text/javascript"></script>
    <script src="/bower_components/backbone/backbone.js" type="text/javascript"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.js" type="text/javascript"></script>
    <script src="/bower_components/base64/base64.js" type="text/javascript"></script>
    <script src="/bower_components/datatables/media/js/jquery.dataTables.js" type="text/javascript" charset="utf8"></script>
    <script src="/bower_components/datatables-bootstrap3/BS3/assets/js/dataTables.js" type="text/javascript" charset="utf8"></script>

    <script src="js/lib/facebook-sdk.js" type="text/javascript"></script>
    <script src="js/lib/auth-utils.js" type="text/javascript"></script>
    <script src="js/lib/constants.js" type="text/javascript"></script>

    <script src="js/models/session.js" type="text/javascript"></script>

    <script src="js/models/game.js" type="text/javascript"></script>
    <script src="js/collections/games.js" type="text/javascript"></script>
    <script src="js/models/user.js" type="text/javascript"></script>
    <script src="js/collections/users.js" type="text/javascript"></script>
    <script src="js/models/team.js" type="text/javascript"></script>
    <script src="js/collections/teams.js" type="text/javascript"></script>

    <script src="js/models/target.js" type="text/javascript"></script>
    <script src="js/models/leaderboard.js" type="text/javascript"></script>
    <script src="js/models/rules.js" type="text/javascript"></script>
    
    <script src="js/views/profile-view.js" type="text/javascript"></script>
    <script src="js/views/target-view.js" type="text/javascript"></script>
    <script src="js/views/leaderboard-view.js" type="text/javascript"></script>
    <script src="js/views/rules-view.js" type="text/javascript"></script>
    
    <script src="js/views/admin-users-view.js" type="text/javascript"></script>
    <script src="js/views/admin-users-teams-view.js" type="text/javascript"></script>
    
    <script src="js/views/app-view.js" type="text/javascript"></script>
    <script src="js/views/nav-view.js" type="text/javascript"></script>
    <script src="js/views/select-game-view.js" type="text/javascript"></script>
    <script src="js/views/nav-game-view.js" type="text/javascript"></script>
    <script src="js/views/login-view.js" type="text/javascript"></script>
    <script src="js/routers/baserouter.js" type="text/javascript"></script>
    <script src="js/routers/router.js" type="text/javascript"></script>
    <script src="js/app.js" type="text/javascript"></script>
</head>

<body>
    <section id="app">
        <section id="nav_body"></section>

        <section class="container-fluid" id="app_body"></section>
    </section>
</body>
</html>